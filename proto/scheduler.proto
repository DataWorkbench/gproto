syntax = "proto3";

option go_package = "github.com/DataWorkbench/gproto/pkg/shpb";

package shpb;

import "github.com/mwitkow/go-proto-validators/validator.proto";
import "model.proto";


// Scheduler Service
service Scheduler {
	// Push pushes the release workflow.
	rpc Push(PushRequest)     returns (model.EmptyStruct) {}
	// Remove removes the offline workflow.
	rpc Remove(RemoveRequest) returns (model.EmptyStruct) {}
	// Report reports the node instance task execute result.
	rpc Report(ReportRequest) returns (model.EmptyStruct) {}
}

// Request parameters used to Push.
message PushRequest {
	string SpaceId = 1                [ (validator.field) = { length_eq: 20 } ];
	string FlowId = 2                 [ (validator.field) = { length_eq: 20 } ];
	int64  Version = 3                [ (validator.field) = { int_gt: 0 } ];
	repeated model.NodeInfo Nodes = 4 [ (validator.field) = { } ];
	model.SchInfo Schedule = 5        [ (validator.field) = { } ];
}

// Request parameters used to Remove.
message RemoveRequest {
	string FlowId = 1 [ (validator.field) = { length_eq: 20 } ];
}

message ReportRequest {
	string InstanceId = 1 [ (validator.field) = { length_eq: 20 } ];
	int32  Status = 2     [ (validator.field) = { } ];
}
