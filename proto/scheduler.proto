syntax = "proto3";

option go_package = "github.com/DataWorkbench/gproto/pkg/shpb";

package shpb;

import "github.com/mwitkow/go-proto-validators/validator.proto";
import "model.proto";


// Scheduler Service
service Scheduler {
	// Add adds a release workflow to schedule system.
	rpc Add(AddRequest) returns (model.EmptyStruct) {}
	// Remove removes a workflow from schedule system.
	rpc Remove(RemoveRequest) returns (model.EmptyStruct) {}
}

// TaskInfo declares a task of release workflow.
message TaskInfo {
	string space_id = 1               [ (validator.field) = { length_eq: 20 } ];
	string flow_id = 2                [ (validator.field) = { length_eq: 20 } ];
	int64  version = 3                [ (validator.field) = { int_gt: 0 } ];
	repeated model.NodeInfo nodes = 4 [ (validator.field) = { } ];
	model.SchInfo schedule = 5        [ (validator.field) = { } ];
}

// Request parameters used to Push.
message AddRequest {
	string space_id = 1               [ (validator.field) = { length_eq: 20 } ];
	string flow_id = 2                [ (validator.field) = { length_eq: 20 } ];
	int64  version = 3                [ (validator.field) = { int_gt: 0 } ];
	repeated model.NodeInfo nodes = 4 [ (validator.field) = { } ];
	model.SchInfo schedule = 5        [ (validator.field) = { } ];
}

// Request parameters used to Remove.
message RemoveRequest {
	string flow_id = 1 [ (validator.field) = { length_eq: 20 } ];
}
