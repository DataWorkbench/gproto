syntax = "proto3";

option go_package = "github.com/DataWorkbench/gproto/pkg/enginepb";

package enginepb;

import "github.com/mwitkow/go-proto-validators/validator.proto";


message Engine{
    string ID = 1 [ (validator.field) = {length_eq: 20} ];
    string Name = 2 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string ShowName = 3 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string Owner = 4 [ (validator.field) = { length_lt: 65 } ];
    string Version = 5;
    enum EngineType {
        INBUILT = 0;
        EXTERNAL = 1;
    }
    EngineType Type = 6;  // inbuilt, external
    int32 Recommend = 7;  // 0 or 1
    string URL = 8;
}

message ListRequest {
    string Owner = 1 [ (validator.field) = { string_not_empty: true } ];
    string Type = 2;  // inbuilt, external
    int32 Limit = 3 [ (validator.field) = { int_gt: 0, int_lt: 101 } ];
    int32 Offset = 4 [ (validator.field) = { msg_exists: true } ];
    int32 Verbose = 5;
}

message ListResponse {
    repeated Engine Engines = 1 [ (validator.field) = { msg_exists: false } ];
    string StatusCode = 2;
}

message DescribeRequest {
    string ID = 1 [ (validator.field) = {length_eq: 20} ];
}

message DescribeResponse {
    Engine info = 1;
    string StatusCode = 2;
}


message RegisterRequest {
    string Name = 1 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string ShowName = 2 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string Owner = 3 [ (validator.field) = { length_lt: 65 } ];
    string URL = 4;
}

message RegisterResponse {
    string StatusCode = 1;
    string Message = 2;
}

message ModifyRequest {
    string ID = 1 [ (validator.field) = {length_eq: 20} ];
    string Name = 2 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string ShowName = 3 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string Owner = 4 [ (validator.field) = { length_lt: 65 } ];
    string URL = 5;
}

message ModifyResponse {
    string StatusCode = 1;
    string Message = 2;
}

message DeleteRequest {
    repeated string ID = 1 [ (validator.field) = {length_eq: 20} ];
}

message DeleteResponse {
    string StatusCode = 1;
    string Message = 2;
}

message CreateRequest {
    string Name = 1 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string ShowName = 2 [ (validator.field) = { length_gt: 1, length_lt: 128 } ];
    string Owner = 3 [ (validator.field) = { length_lt: 65 } ];
    string URL = 4;
}

message CreateResponse {
    string StatusCode = 1;
    string Message = 2;
}

// Engine Service
service EngineService {
    rpc List(ListRequest) returns (ListResponse) {}
    rpc Describe(DescribeRequest) returns (DescribeResponse) {}
    rpc Register(RegisterRequest) returns (RegisterResponse) {}
    rpc Modify(ModifyRequest) returns (ModifyResponse) {}
    rpc Delete(DeleteRequest) returns (DeleteResponse) {}
    rpc Create(CreateRequest) returns (CreateResponse) {}
}
